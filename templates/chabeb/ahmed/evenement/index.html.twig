{% extends 'baseback.html.twig' %}

{% block title %}Liste des Événements{% endblock %}

{% block body %}
{{ parent() }}

    <h1>Liste des événements</h1>

    {# Affichage des messages flashs #}
    {% for message in app.flashes('success') %}
        <div class="alert alert-success">{{ message }}</div>
    {% endfor %}

    {# Formulaire de filtrage #}
    <form method="get">
        <div class="form-group">
            <label for="type">Type d'événement</label>
            <input type="text" name="type" id="type" class="form-control" value="{{ type }}">

        </div>
        <div class="form-group">
            <label for="dateDebut">Date de début</label>
            <input type="date" name="dateDebut" id="dateDebut" class="form-control" value="{{ dateDebut }}">
        </div>
        <div class="form-group">
            <label for="dateFin">Date de fin</label>
            <input type="date" name="dateFin" id="dateFin" class="form-control" value="{{ dateFin }}">
        </div>
        <button type="submit" class="btn btn-primary">chercher</button>
    </form>

    {# Tableau des événements #}
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Type</th>
                <th>Date de début</th>
                <th>Date de fin</th>
                <th>Lieu</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for evenement in evenements %}
                <tr>
                    <td>{{ evenement.id }}</td>
                    <td>{{ evenement.type }}</td>
                    <td>{{ evenement.dateDebut|date('d/m/Y H:i') }}</td>
                    <td>{{ evenement.dateFin|date('d/m/Y H:i') }}</td>
                    <td>{{ evenement.lieu }}</td>
                    <td>
                        <a href="{{ path('evenement_show', {'id': evenement.id}) }}" class="btn btn-info btn-sm">Voir</a>
                        <a href="{{ path('evenement_edit', {'id': evenement.id}) }}" class="btn btn-primary btn-sm">Modifier</a>
                        <form method="post" action="{{ path('evenement_delete', {'id': evenement.id}) }}" onsubmit="return confirm('Êtes-vous sûr ?');" style="display:inline-block;">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ evenement.id) }}">
                            <button class="btn btn-danger btn-sm">Supprimer</button>
                        </form>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="5">Aucun événement trouvé.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    {# Pagination #}
    {{ knp_pagination_render(evenements) }}

    {# Lien vers la création d'un nouvel événement #}
    <a href="{{ path('evenement_new') }}" class="btn btn-success">Créer un nouvel événement</a>
{% endblock %}
